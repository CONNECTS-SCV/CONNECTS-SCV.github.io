<button class="menu-btn" onclick="toggleSidebar()" aria-label="메뉴 토글">
  <div class="menu-icon">
    <span class="line line__1"></span>
    <span class="line line__2"></span>
    <span class="line line__3"></span>
  </div>
</button>

<hy-drawer>
  <header id="_sidebar" class="sidebar" role="banner">
    {% if image.background %}
      {% capture bg_style %}background:{{ image.background }}{% endcapture %}
      {% capture bg_class %}sidebar-bg {% if image.overlay %}sidebar-overlay{% endif %}{% endcapture %}
    {% else %}
      {% capture bg_style %}background-color:{{ color }};{% if image != 'none' %}background-image:url({% include smart-url url=image %}){% endif %}{% endcapture %}
      {% capture bg_class %}sidebar-bg {% if image != 'none' %}sidebar-overlay{% endif %}{% endcapture %}
    {% endif %}
    <div class="{{ bg_class }}" style="{{ bg_style }}"></div>

    <div class="sidebar-sticky">
      <nav class="sidebar-nav" role="navigation">
        {% include nav.html %}
      </nav>
    </div>
  </header>
</hy-drawer>

<script>
function toggleSidebar() {
  const drawer = document.querySelector('hy-drawer');
  const menuBtn = document.querySelector('.menu-btn');
  const body = document.body;
  
  if (drawer && menuBtn) {
    drawer.classList.toggle('nav-open');
    menuBtn.classList.toggle('nav-open');
    menuBtn.classList.toggle('close');
    body.classList.toggle('sidebar-open');
    
    // Save state to localStorage
    const isOpen = drawer.classList.contains('nav-open');
    localStorage.setItem('sidebarState', isOpen ? 'open' : 'closed');
  }
}

// Initialize on page load - restore saved state
document.addEventListener('DOMContentLoaded', function() {
  const savedState = localStorage.getItem('sidebarState');
  const drawer = document.querySelector('hy-drawer');
  const menuBtn = document.querySelector('.menu-btn');
  const body = document.body;
  
  // Restore previous state
  if (savedState === 'open' && drawer && menuBtn) {
    drawer.classList.add('nav-open');
    menuBtn.classList.add('nav-open');
    menuBtn.classList.add('close');
    body.classList.add('sidebar-open');
  }
});
</script>
