---
layout: post
title: "GROMACS 분자동역학 시뮬레이션 도구 정복하기"
description: >
    GROMACS는 생체분자와 재료계 모두에 적용 가능한 고성능 오픈소스 분자동역학(MD) 시뮬레이션 도구입니다. 빠른 속도, 다양한 포스필드 지원, 유연한 분석 기능으로 MD 연구의 표준 툴로 자리잡고 있습니다.
categories:
    - analysis
    - structure
    - simulation
tags: [GROMACS, MD 시뮬레이션, 분자동역학, 포스필드, 시뮬레이션 파이프라인, GPU 가속, RMSD, 자유에너지]
author: author
---

## 🔬 GROMACS란?

**GROMACS(GROningen MAchine for Chemical Simulations)** 는 **분자동역학(MD)** 시뮬레이션을 위한 대표적인 오픈소스 소프트웨어입니다.

* 단백질, 핵산, 지질, 소분자 등 **생체분자 시스템** 뿐 아니라, **재료/폴리머** 시뮬레이션에도 폭넓게 활용됩니다.
* CPU와 GPU **병렬화** 에 최적화되어 **대형 시스템 처리 속도** 가 탁월합니다.

---

## ⚙️ 작동 원리 및 차별점

### 🧬 핵심 원리

* 포스필드로 원자 간 상호작용(결합, 각, 비결합)을 정의하고, **뉴턴 방정식을 수치적으로 적분** 하여 원자의 시간적 변화를 계산합니다.
* 시뮬레이션 기본 단계:

    * 에너지 최소화 (EM)
    * NVT 등온 등적 조건
    * NPT 등온 등압 조건
    * 생산 런 (Production MD)

### 🔍 주요 계산 요소

| 항목       | 설명                                                   |
| -------- | ---------------------------------------------------- |
| 장거리 전기력  | PME (Particle Mesh Ewald)                            |
| 제약 알고리즘  | LINCS (H-결합 고정시 dt = 2 fs 가능)                        |
| 온도/압력 조절 | V-rescale, Nosé–Hoover / Parrinello–Rahman           |
| 이웃 리스트   | `rlist`, `rcoulomb`, `rvdw`, `nstlist` 등으로 성능/정확도 조정 |

### 💡 GROMACS의 강점

* **속도와 효율**: 짧은 타임스텝 반복을 빠르게 수행하며, 대형 시스템에서 고성능 발휘
* **다양한 포스필드 지원**: AMBER, CHARMM, OPLS-AA, 물 모델 TIP3P/4P 등
* **강력한 분석 기능**: `gmx rms`, `gmx sasa`, `gmx hbond`, `gmx cluster` 등 내장 분석 도구 제공

---

## 📝 사용 방법 안내

### A. 입력 파일

* **구조 파일**: `.pdb`, `.gro`
* **포스필드/물 모델**: AMBER, CHARMM, OPLS-AA / TIP3P, TIP4P 등
* **시뮬레이션 파라미터**: `.mdp` 파일 (적분기, 제약, 온도, 압력 등 포함)

### B. 전형적인 파이프라인

```bash
# 1) 토폴로지/수소 추가/프로톤화 상태 지정
gmx pdb2gmx -f input.pdb -o processed.gro -p topol.top -i posre.itp

# 2) 박스 설정 (여유 1.0 nm)
gmx editconf -f processed.gro -o boxed.gro -c -d 1.0 -bt cubic

# 3) 용매화
gmx solvate -cp boxed.gro -cs spc216.gro -o solvated.gro -p topol.top

# 4) 이온 추가를 위한 사전 grompp
gmx grompp -f ions.mdp -c solvated.gro -p topol.top -o ions.tpr

# 5) 중화 및 이온 농도 설정 (예: 0.15 M NaCl)
echo "SOL" | gmx genion -s ions.tpr -o solv_ions.gro -p topol.top -pname NA -nname CL -neutral -conc 0.15

# 6) 에너지 최소화
gmx grompp -f em.mdp -c solv_ions.gro -p topol.top -o em.tpr
gmx mdrun -deffnm em

# 7) NVT (위치제약 on)
gmx grompp -f nvt.mdp -c em.gro -r em.gro -p topol.top -o nvt.tpr
gmx mdrun -deffnm nvt

# 8) NPT (위치제약 on)
gmx grompp -f npt.mdp -c nvt.gro -r nvt.gro -t nvt.cpt -p topol.top -o npt.tpr
gmx mdrun -deffnm npt

# 9) 생산 런 (제약 해제)
gmx grompp -f md.mdp -c npt.gro -t npt.cpt -p topol.top -o md.tpr
gmx mdrun -deffnm md
```

### C. 기본 MDP 설정 요약

| 항목    | 설정 예시                                                   |
| ----- | ------------------------------------------------------- |
| 적분기   | `integrator = md`, `dt = 0.002`                         |
| 제약    | `constraints = h-bonds`, `constraint-algorithm = lincs` |
| 전기력   | `coulombtype = PME`                                     |
| 컷오프   | `rcoulomb = 1.0`, `rvdw = 1.0`                          |
| 온도/압력 | `tcoupl = V-rescale`, `pcoupl = Parrinello-Rahman`      |
| 이웃리스트 | `nstlist = 20`, `rlist = 1.0`                           |

### D. 분석 명령 예시

```bash
gmx rms   -s md.tpr -f md.xtc -o rmsd.xvg
gmx rmsf  -s md.tpr -f md.xtc -o rmsf.xvg -res
gmx hbond -s md.tpr -f md.xtc -num hbond_count.xvg
gmx sasa   -s md.tpr -f md.xtc -o sasa.xvg
gmx cluster -s md.tpr -f noPBC.xtc -o clusters.pdb -method gromos -cutoff 0.2
```

### E. 품질 체크리스트

* EM 수렴: Fmax < 1000 kJ/mol/nm
* NVT: 온도 안정화 확인
* NPT: 밀도 \~1.0 g/cm³ 도달, 상자 크기 안정
* Production: RMSD plateau 확인
* PBC 정리: `trjconv -pbc mol -center` 등 필수

---

## 🧬 분석 활용 예시

* **리간드 안정성 평가**: RMSD/RMSF, 접촉 수, H-bond 지속 시간
* **돌연변이 영향 분석**: WT vs Mutant의 구조 변화 비교
* **막단백질-지질 상호작용**: 삽입 깊이, 침투성 등 평가
* **수화 네트워크 분석**: RDF, 수소결합 히트맵 등
* **자유에너지/친화도 계산**: MM/PBSA, FEP/PMF 등 활용
* **재료 물성 시뮬레이션**: 확산, 계면 거동, 기계적 특성 등

---

## 🔁 관련 도구 비교 및 연계 분석

| 도구     | 특징                 |
| ------ | ------------------ |
| NAMD   | 초대형 시스템, 슈퍼컴 최적화   |
| AMBER  | 포스필드 다양성, 생물학계 특화  |
| CHARMM | 샘플링 기법/분석 도구 다양    |
| OpenMM | Python 기반, GPU에 강함 |
| LAMMPS | 재료계, 커스텀 상호작용에 최적  |

> 실제 실험에서는 GROMACS와 외부 툴을 혼합 사용하며, 각 목적에 따라 도구 선택이 중요합니다.

---

## 🔗 외부 모듈 연계 예시

* **Docking → MD**: DiffDock/AutoDock 결과를 NVT/NPT 안정화 후 MD → 포즈 유지 평가
* **MD → Interaction Profiling**: PLIP/Arpeggio로 상호작용 분석
* **MD → 친화도 평가**: PRODIGY, MM/PBSA, FEP 등으로 정량 분석
* **자동화 후처리**: MDAnalysis, PyEMMA로 대규모 데이터 분석
* **시각화 도구**: VMD, PyMOL, ChimeraX 등으로 시각화 최적화

---

## ⚠️ 실무 팁 및 자주 겪는 문제

### 성능 튜닝

* GPU PME 활성화
* `nstlist`, `verlet-buffer-tolerance` 조정
* MPI/Thread 수 미세 조정

### 자주 겪는 이슈

* 이상한 밀도/압력: 바소스타/시간상수 설정 확인
* PBC 꼬임: `trjconv -pbc mol -center -ur compact`
* 이온 강도 문제: `genion -conc` 사용 후 체적 확인
* 메탈 계열: 명시적인 파라미터 및 결합 제약 필요

### 체크포인트

* 포스필드와 물모형은 세트로 구성
* NVT/NPT 충분히 수행 후 MD 진입
* 덤프 간격은 목적/성능에 맞게 조정
* 분석은 RMSD/RMSF + 접촉 + 에너지 등 복합 해석 필요

---

> 지금 바로 <a href="#" onclick="window.open('https://curie.kr/Analysis/GROMACS', '_blank'); return false;" rel="noopener noreferrer">GROMACS 분석 페이지</a>에서 직접 사용해보세요!
